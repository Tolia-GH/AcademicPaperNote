# A novel approach based on a modified mask R-CNN for the weight prediction of live pigs

[source file](./R-CNN-2023.11-PigWeightPrediction.pdf)

### Journal 期刊
**SCI II**: IEEE SENSORS JOURNAL
### KeyWords 关键词
- Deep learning 深度学习
- Modified mask R-CNN 改进掩模区域卷积神经网络
- Image processing 图像处理
- Pig weight Prediction 猪体重预测
### Algorithm 算法
- DeepLearning 深度学习
- Deep Neural Network 深度神经网络
- 改进掩模区域卷积神经网络（mask R-CNN）
### Innovation 创新点
- 基于改进掩模区域卷积神经网络（mask R-CNN）的新型猪体重预测方法
- 修改后的方法使用ResNeSt作为骨干特征提取网络来增强图像特征提取能力
  
### Value 价值

- 机器学习模型有效预测了生猪体重值，为猪场智能化管理提供技术支撑。
  

### Abstract 摘要

Since determining the weight of pigs during large-scale breeding and production is challenging, using noncontact estimation methods is vital. This study proposed a novel pig weight prediction method based on a modified mask region-convolutional neural network (mask R-CNN). The modified approach used ResNeSt as the backbone feature extraction network to enhance the image feature extraction ability. The feature pyramid network (FPN) was added to the backbone feature extraction network for multi-scale feature fusion. The channel attention mechanism (CAM) and spatial attention mechanism (SAM) were introduced in the region proposal network (RPN) for the adaptive integration of local features and their global dependencies to capture global information, ultimately improving image segmentation accuracy. The modified network obtained a precision rate(P), recall rate (R), and mean average precision (MAP) of 90.33%, 89.85%, and 95.21%, respectively, effectively segmenting the pig regions in the images. Five image features, namely the back area, body length, body width,average depth, and eccentricity, were investigated. The pig depth images were used to build five regression algorithms (ordinary least squares (OLS), AdaBoost, CatBoost, XGBoost, and random forest (RF)) for weight value prediction. AdaBoost achieved the best prediction result with a coefficient of determination (R2) of 0.987, a mean absolute error (MAE) of 2.96 kg, a mean square error (MSE) of 12.87 kg2, and a mean absolute percentage error (MAPE) of 8.45%. The results demonstrated that the machine learning models effectively predicted the weight values of the pigs, providing technical support for intelligent pig farm management.
由于在大规模饲养和生产过程中确定猪的体重具有挑战性，因此使用非接触式估算方法至关重要。 本研究提出了一种基于改进掩模区域卷积神经网络（mask R-CNN）的新型猪体重预测方法。 修改后的方法使用ResNeSt作为骨干特征提取网络来增强图像特征提取能力。 将特征金字塔网络（FPN）添加到主干特征提取网络中以进行多尺度特征融合。 在区域提议网络（RPN）中引入通道注意机制（CAM）和空间注意机制（SAM），用于自适应集成局部特征及其全局依赖性以捕获全局信息，最终提高图像分割精度。 修改后的网络的准确率（P）、召回率（R）和平均准确率（MAP）分别为90.33%、89.85%和95.21%，有效地分割了图像中的猪区域。 研究了五种图像特征，即背部面积、体长、体宽、平均深度和偏心率。 使用猪深度图像构建五种回归算法（普通最小二乘法 (OLS)、AdaBoost、CatBoost、XGBoost 和随机森林 (RF)）来预测体重值。 AdaBoost 取得了最佳预测结果，确定系数（R2）为 0.987，平均绝对误差（MAE）为 2.96 kg，均方误差（MSE）为 12.87 kg2，平均绝对百分比误差（MAPE）为 8.45 %。 结果表明，机器学习模型有效预测了生猪体重值，为猪场智能化管理提供技术支撑。